//
//  VoltorbFlipGrid.cpp
//
//  Copyright (c) 2014 David Zhu. All rights reserved.
//

#include "VoltorbFlipGrid.h"
#include <cassert>

VoltorbFlipGrid::VoltorbFlipGrid( const VoltorbFlipLine< VoltorbFlipClue >& rowClues, const VoltorbFlipLine< VoltorbFlipClue >& columnClues ) :
m_rowClues( rowClues ),
m_columnClues( columnClues )
{
    for ( auto& row : m_gridRepresentation )
    {
        for ( int& cell : row )
        {
            cell = UnknownValue;
        }
    }
}

std::vector< VoltorbFlipGrid > VoltorbFlipGrid::solve() const
{
    std::vector< VoltorbFlipGrid > solutions;
    this->solveRecursively( *this, solutions );
    return solutions;
}

bool VoltorbFlipGrid::solveRecursively( const VoltorbFlipGrid& testState, std::vector< VoltorbFlipGrid >& solutions ) const
{
    // Find out which row we should work with.
    int rowIndex = VoltorbFlipGrid::getFirstUnfilledRowOfGrid( testState );

    if ( rowIndex == GridSize )
    {
        // Base case. We've populated every row.
        // Do a final strong column verification.
        if ( this->verifyGrid( testState, true ) )
        {
            // No duplicate solutions.
            {
                for ( const auto& solution : solutions )
                {
                    assert( solution.m_gridRepresentation != testState.m_gridRepresentation && "Same solution has already been recorded" );
                }
            }

            solutions.push_back( testState );
        }
    }
    else
    {
        // Recursion. Populate the first incomplete row and recurse.
        // Try all rows that match this row's clue.
        for ( const auto& testRow : ReferenceClues.at( m_rowClues[ rowIndex ] ) )
        {
            auto nextState = testState;
            nextState.m_gridRepresentation[ rowIndex ] = testRow;

            if ( this->verifyGrid( nextState ) )
            {
                // Test row is plausible
                this->solveRecursively( nextState, solutions );
            }
        } // Loop over all test rows corresponding to this row's clue
    }

    return solutions.size() > 0;
}

const int VoltorbFlipGrid::ZeroValue = 0;
const int VoltorbFlipGrid::OneValue = 1;
const int VoltorbFlipGrid::TwoValue = 2;
const int VoltorbFlipGrid::ThreeValue = 3;
const int VoltorbFlipGrid::CouldBeZeroOrOneValue = 4;
const int VoltorbFlipGrid::UnknownValue = 15;

int VoltorbFlipGrid::getFirstUnfilledRowOfGrid( const VoltorbFlipGrid& testState )
{
    int rowIndex = 0;
    for ( ; rowIndex<GridSize; rowIndex++ )
    {
        for ( auto cell : testState.m_gridRepresentation[ rowIndex ] )
        {
            if ( ( cell == CouldBeZeroOrOneValue ) || ( cell == UnknownValue ) )
            {
                return rowIndex;
            }
        }
    }

    return GridSize;
}

VoltorbFlipGrid::VoltorbFlipLine< int > VoltorbFlipGrid::getColumnOfGrid( const VoltorbFlipGrid& testState, int columnIndex )
{
    VoltorbFlipLine< int > column;
    for ( int r=0; r<GridSize; r++ )
    {
        column[ r ] = testState( r, columnIndex );
    }
    return column;
}

bool VoltorbFlipGrid::verifyLine( const VoltorbFlipLine< int >& referenceLine, const VoltorbFlipLine< int >& testLine, bool strongMatch )
{
    if ( strongMatch )
    {
        return referenceLine == testLine;
    }

    for ( int i=0; i<GridSize; i++ )
    {
        switch ( testLine[ i ] )
        {
        case UnknownValue:
            break;

        case CouldBeZeroOrOneValue:
            if ( ( referenceLine[ i ] != ZeroValue ) &&
                ( referenceLine[ i ] != OneValue ) )
            {
                return false;
            }
            break;

        default:
            if ( referenceLine[ i ] != testLine[ i ] )
            {
                return false;
            }
            break;
        }
    }

    return true;
}

bool VoltorbFlipGrid::verifyGrid( const VoltorbFlipGrid& testState, bool strongMatch ) const
{
    // Check against pre-filled.
    for ( int r=0; r<GridSize; r++ )
    {
        for ( int c=0; c<GridSize; c++ )
        {
            switch ( m_gridRepresentation[ r ][ c ] )
            {
            case CouldBeZeroOrOneValue:
                if ( ( testState.m_gridRepresentation[ r ][ c ] == TwoValue ) ||
                    ( testState.m_gridRepresentation[ r ][ c ] == ThreeValue ) )
                {
                    return false;
                }
                break;

            case UnknownValue:
                break;

            default:
                if ( m_gridRepresentation[ r ][ c ] != testState.m_gridRepresentation[r][c] )
                {
                    return false;
                }
                break;
            }
        }
    }

    // Agreement with reference clues
    for ( int c=0; c<GridSize; c++ )
    {
        auto column = this->getColumnOfGrid( testState, c );
        bool columnIsPossible = false;
        for ( const auto& referenceColumn : ReferenceClues.at( m_columnClues[ c ] ) )
        {
            if ( VoltorbFlipGrid::verifyLine( referenceColumn, column, strongMatch ) )
            {
                columnIsPossible = true;
                break;
            }
        }

        if ( !columnIsPossible )
        {
            return false;
        }
    }

    return true;
}

const std::map< VoltorbFlipGrid::VoltorbFlipClue, std::vector< VoltorbFlipGrid::VoltorbFlipLine< int > > > VoltorbFlipGrid::ReferenceClues =
{
    { { 0, 5 },
    { { 0, 0, 0, 0, 0 } } },

    { { 1, 4 },
    { { 0, 0, 0, 0, 1 },
    { 0, 0, 0, 1, 0 },
    { 0, 0, 1, 0, 0 },
    { 0, 1, 0, 0, 0 },
    { 1, 0, 0, 0, 0 }
    } },

    { { 2, 3 },
    { { 0, 0, 0, 1, 1 },
    { 0, 0, 1, 0, 1 },
    { 0, 0, 1, 1, 0 },
    { 0, 1, 0, 0, 1 },
    { 0, 1, 0, 1, 0 },
    { 0, 1, 1, 0, 0 },
    { 1, 0, 0, 0, 1 },
    { 1, 0, 0, 1, 0 },
    { 1, 0, 1, 0, 0 },
    { 1, 1, 0, 0, 0 }
    } },

    { { 2, 4 },
    { { 0, 0, 0, 0, 2 },
    { 0, 0, 0, 2, 0 },
    { 0, 0, 2, 0, 0 },
    { 0, 2, 0, 0, 0 },
    { 2, 0, 0, 0, 0 }
    } },

    { { 3, 2 },
    { { 0, 0, 1, 1, 1 },
    { 0, 1, 0, 1, 1 },
    { 0, 1, 1, 0, 1 },
    { 0, 1, 1, 1, 0 },
    { 1, 0, 0, 1, 1 },
    { 1, 0, 1, 0, 1 },
    { 1, 0, 1, 1, 0 },
    { 1, 1, 0, 0, 1 },
    { 1, 1, 0, 1, 0 },
    { 1, 1, 1, 0, 0 }
    } },

    { { 3, 3 },
    { { 0, 0, 0, 1, 2 },
    { 0, 0, 0, 2, 1 },
    { 0, 0, 1, 0, 2 },
    { 0, 0, 1, 2, 0 },
    { 0, 0, 2, 0, 1 },
    { 0, 0, 2, 1, 0 },
    { 0, 1, 0, 0, 2 },
    { 0, 1, 0, 2, 0 },
    { 0, 1, 2, 0, 0 },
    { 0, 2, 0, 0, 1 },
    { 0, 2, 0, 1, 0 },
    { 0, 2, 1, 0, 0 },
    { 1, 0, 0, 0, 2 },
    { 1, 0, 0, 2, 0 },
    { 1, 0, 2, 0, 0 },
    { 1, 2, 0, 0, 0 },
    { 2, 0, 0, 0, 1 },
    { 2, 0, 0, 1, 0 },
    { 2, 0, 1, 0, 0 },
    { 2, 1, 0, 0, 0 }
    } },

    { { 3, 4 },
    { { 0, 0, 0, 0, 3 },
    { 0, 0, 0, 3, 0 },
    { 0, 0, 3, 0, 0 },
    { 0, 3, 0, 0, 0 },
    { 3, 0, 0, 0, 0 }
    } },

    { { 4, 1 },
    { { 0, 1, 1, 1, 1 },
    { 1, 0, 1, 1, 1 },
    { 1, 1, 0, 1, 1 },
    { 1, 1, 1, 0, 1 },
    { 1, 1, 1, 1, 0 }
    } },

    { { 4, 2 },
    { { 0, 0, 1, 1, 2 },
    { 0, 0, 1, 2, 1 },
    { 0, 0, 2, 1, 1 },
    { 0, 1, 0, 1, 2 },
    { 0, 1, 0, 2, 1 },
    { 0, 1, 1, 0, 2 },
    { 0, 1, 1, 2, 0 },
    { 0, 1, 2, 0, 1 },
    { 0, 1, 2, 1, 0 },
    { 0, 2, 0, 1, 1 },
    { 0, 2, 1, 0, 1 },
    { 0, 2, 1, 1, 0 },
    { 1, 0, 0, 1, 2 },
    { 1, 0, 0, 2, 1 },
    { 1, 0, 1, 0, 2 },
    { 1, 0, 1, 2, 0 },
    { 1, 0, 2, 0, 1 },
    { 1, 0, 2, 1, 0 },
    { 1, 1, 0, 0, 2 },
    { 1, 1, 0, 2, 0 },
    { 1, 1, 2, 0, 0 },
    { 1, 2, 0, 0, 1 },
    { 1, 2, 0, 1, 0 },
    { 1, 2, 1, 0, 0 },
    { 2, 0, 0, 1, 1 },
    { 2, 0, 1, 0, 1 },
    { 2, 0, 1, 1, 0 },
    { 2, 1, 0, 0, 1 },
    { 2, 1, 0, 1, 0 },
    { 2, 1, 1, 0, 0 }
    } },

    { { 4, 3 },
    { { 0, 0, 0, 1, 3 },
    { 0, 0, 0, 2, 2 },
    { 0, 0, 0, 3, 1 },
    { 0, 0, 1, 0, 3 },
    { 0, 0, 1, 3, 0 },
    { 0, 0, 2, 0, 2 },
    { 0, 0, 2, 2, 0 },
    { 0, 0, 3, 0, 1 },
    { 0, 0, 3, 1, 0 },
    { 0, 1, 0, 0, 3 },
    { 0, 1, 0, 3, 0 },
    { 0, 1, 3, 0, 0 },
    { 0, 2, 0, 0, 2 },
    { 0, 2, 0, 2, 0 },
    { 0, 2, 2, 0, 0 },
    { 0, 3, 0, 0, 1 },
    { 0, 3, 0, 1, 0 },
    { 0, 3, 1, 0, 0 },
    { 1, 0, 0, 0, 3 },
    { 1, 0, 0, 3, 0 },
    { 1, 0, 3, 0, 0 },
    { 1, 3, 0, 0, 0 },
    { 2, 0, 0, 0, 2 },
    { 2, 0, 0, 2, 0 },
    { 2, 0, 2, 0, 0 },
    { 2, 2, 0, 0, 0 },
    { 3, 0, 0, 0, 1 },
    { 3, 0, 0, 1, 0 },
    { 3, 0, 1, 0, 0 },
    { 3, 1, 0, 0, 0 }
    } },

    { { 5, 0 },
    { { 1, 1, 1, 1, 1 }
    } },

    { { 5, 1 },
    { { 0, 1, 1, 1, 2 },
    { 0, 1, 1, 2, 1 },
    { 0, 1, 2, 1, 1 },
    { 0, 2, 1, 1, 1 },
    { 1, 0, 1, 1, 2 },
    { 1, 0, 1, 2, 1 },
    { 1, 0, 2, 1, 1 },
    { 1, 1, 0, 1, 2 },
    { 1, 1, 0, 2, 1 },
    { 1, 1, 1, 0, 2 },
    { 1, 1, 1, 2, 0 },
    { 1, 1, 2, 0, 1 },
    { 1, 1, 2, 1, 0 },
    { 1, 2, 0, 1, 1 },
    { 1, 2, 1, 0, 1 },
    { 1, 2, 1, 1, 0 },
    { 2, 0, 1, 1, 1 },
    { 2, 1, 0, 1, 1 },
    { 2, 1, 1, 0, 1 },
    { 2, 1, 1, 1, 0 }
    } },

    { { 5, 2 },
    { { 0, 0, 1, 1, 3 },
    { 0, 0, 1, 2, 2 },
    { 0, 0, 1, 3, 1 },
    { 0, 0, 2, 1, 2 },
    { 0, 0, 2, 2, 1 },
    { 0, 0, 3, 1, 1 },
    { 0, 1, 0, 1, 3 },
    { 0, 1, 0, 2, 2 },
    { 0, 1, 0, 3, 1 },
    { 0, 1, 1, 0, 3 },
    { 0, 1, 1, 3, 0 },
    { 0, 1, 2, 0, 2 },
    { 0, 1, 2, 2, 0 },
    { 0, 1, 3, 0, 1 },
    { 0, 1, 3, 1, 0 },
    { 0, 2, 0, 1, 2 },
    { 0, 2, 0, 2, 1 },
    { 0, 2, 1, 0, 2 },
    { 0, 2, 1, 2, 0 },
    { 0, 2, 2, 0, 1 },
    { 0, 2, 2, 1, 0 },
    { 0, 3, 0, 1, 1 },
    { 0, 3, 1, 0, 1 },
    { 0, 3, 1, 1, 0 },
    { 1, 0, 0, 1, 3 },
    { 1, 0, 0, 2, 2 },
    { 1, 0, 0, 3, 1 },
    { 1, 0, 1, 0, 3 },
    { 1, 0, 1, 3, 0 },
    { 1, 0, 2, 0, 2 },
    { 1, 0, 2, 2, 0 },
    { 1, 0, 3, 0, 1 },
    { 1, 0, 3, 1, 0 },
    { 1, 1, 0, 0, 3 },
    { 1, 1, 0, 3, 0 },
    { 1, 1, 3, 0, 0 },
    { 1, 2, 0, 0, 2 },
    { 1, 2, 0, 2, 0 },
    { 1, 2, 2, 0, 0 },
    { 1, 3, 0, 0, 1 },
    { 1, 3, 0, 1, 0 },
    { 1, 3, 1, 0, 0 },
    { 2, 0, 0, 1, 2 },
    { 2, 0, 0, 2, 1 },
    { 2, 0, 1, 0, 2 },
    { 2, 0, 1, 2, 0 },
    { 2, 0, 2, 0, 1 },
    { 2, 0, 2, 1, 0 },
    { 2, 1, 0, 0, 2 },
    { 2, 1, 0, 2, 0 },
    { 2, 1, 2, 0, 0 },
    { 2, 2, 0, 0, 1 },
    { 2, 2, 0, 1, 0 },
    { 2, 2, 1, 0, 0 },
    { 3, 0, 0, 1, 1 },
    { 3, 0, 1, 0, 1 },
    { 3, 0, 1, 1, 0 },
    { 3, 1, 0, 0, 1 },
    { 3, 1, 0, 1, 0 },
    { 3, 1, 1, 0, 0 }
    } },

    { { 5, 3 },
    { { 0, 0, 0, 2, 3 },
    { 0, 0, 0, 3, 2 },
    { 0, 0, 2, 0, 3 },
    { 0, 0, 2, 3, 0 },
    { 0, 0, 3, 0, 2 },
    { 0, 0, 3, 2, 0 },
    { 0, 2, 0, 0, 3 },
    { 0, 2, 0, 3, 0 },
    { 0, 2, 3, 0, 0 },
    { 0, 3, 0, 0, 2 },
    { 0, 3, 0, 2, 0 },
    { 0, 3, 2, 0, 0 },
    { 2, 0, 0, 0, 3 },
    { 2, 0, 0, 3, 0 },
    { 2, 0, 3, 0, 0 },
    { 2, 3, 0, 0, 0 },
    { 3, 0, 0, 0, 2 },
    { 3, 0, 0, 2, 0 },
    { 3, 0, 2, 0, 0 },
    { 3, 2, 0, 0, 0 }
    } },

    { { 6, 0 },
    { { 1, 1, 1, 1, 2 },
    { 1, 1, 1, 2, 1 },
    { 1, 1, 2, 1, 1 },
    { 1, 2, 1, 1, 1 },
    { 2, 1, 1, 1, 1 }
    } },

    { { 6, 1 },
    { { 0, 1, 1, 1, 3 },
    { 0, 1, 1, 2, 2 },
    { 0, 1, 1, 3, 1 },
    { 0, 1, 2, 1, 2 },
    { 0, 1, 2, 2, 1 },
    { 0, 1, 3, 1, 1 },
    { 0, 2, 1, 1, 2 },
    { 0, 2, 1, 2, 1 },
    { 0, 2, 2, 1, 1 },
    { 0, 3, 1, 1, 1 },
    { 1, 0, 1, 1, 3 },
    { 1, 0, 1, 2, 2 },
    { 1, 0, 1, 3, 1 },
    { 1, 0, 2, 1, 2 },
    { 1, 0, 2, 2, 1 },
    { 1, 0, 3, 1, 1 },
    { 1, 1, 0, 1, 3 },
    { 1, 1, 0, 2, 2 },
    { 1, 1, 0, 3, 1 },
    { 1, 1, 1, 0, 3 },
    { 1, 1, 1, 3, 0 },
    { 1, 1, 2, 0, 2 },
    { 1, 1, 2, 2, 0 },
    { 1, 1, 3, 0, 1 },
    { 1, 1, 3, 1, 0 },
    { 1, 2, 0, 1, 2 },
    { 1, 2, 0, 2, 1 },
    { 1, 2, 1, 0, 2 },
    { 1, 2, 1, 2, 0 },
    { 1, 2, 2, 0, 1 },
    { 1, 2, 2, 1, 0 },
    { 1, 3, 0, 1, 1 },
    { 1, 3, 1, 0, 1 },
    { 1, 3, 1, 1, 0 },
    { 2, 0, 1, 1, 2 },
    { 2, 0, 1, 2, 1 },
    { 2, 0, 2, 1, 1 },
    { 2, 1, 0, 1, 2 },
    { 2, 1, 0, 2, 1 },
    { 2, 1, 1, 0, 2 },
    { 2, 1, 1, 2, 0 },
    { 2, 1, 2, 0, 1 },
    { 2, 1, 2, 1, 0 },
    { 2, 2, 0, 1, 1 },
    { 2, 2, 1, 0, 1 },
    { 2, 2, 1, 1, 0 },
    { 3, 0, 1, 1, 1 },
    { 3, 1, 0, 1, 1 },
    { 3, 1, 1, 0, 1 },
    { 3, 1, 1, 1, 0 }
    } },

    { { 6, 2 },
    { { 0, 0, 1, 2, 3 },
    { 0, 0, 1, 3, 2 },
    { 0, 0, 2, 1, 3 },
    { 0, 0, 2, 2, 2 },
    { 0, 0, 2, 3, 1 },
    { 0, 0, 3, 1, 2 },
    { 0, 0, 3, 2, 1 },
    { 0, 1, 0, 2, 3 },
    { 0, 1, 0, 3, 2 },
    { 0, 1, 2, 0, 3 },
    { 0, 1, 2, 3, 0 },
    { 0, 1, 3, 0, 2 },
    { 0, 1, 3, 2, 0 },
    { 0, 2, 0, 1, 3 },
    { 0, 2, 0, 2, 2 },
    { 0, 2, 0, 3, 1 },
    { 0, 2, 1, 0, 3 },
    { 0, 2, 1, 3, 0 },
    { 0, 2, 2, 0, 2 },
    { 0, 2, 2, 2, 0 },
    { 0, 2, 3, 0, 1 },
    { 0, 2, 3, 1, 0 },
    { 0, 3, 0, 1, 2 },
    { 0, 3, 0, 2, 1 },
    { 0, 3, 1, 0, 2 },
    { 0, 3, 1, 2, 0 },
    { 0, 3, 2, 0, 1 },
    { 0, 3, 2, 1, 0 },
    { 1, 0, 0, 2, 3 },
    { 1, 0, 0, 3, 2 },
    { 1, 0, 2, 0, 3 },
    { 1, 0, 2, 3, 0 },
    { 1, 0, 3, 0, 2 },
    { 1, 0, 3, 2, 0 },
    { 1, 2, 0, 0, 3 },
    { 1, 2, 0, 3, 0 },
    { 1, 2, 3, 0, 0 },
    { 1, 3, 0, 0, 2 },
    { 1, 3, 0, 2, 0 },
    { 1, 3, 2, 0, 0 },
    { 2, 0, 0, 1, 3 },
    { 2, 0, 0, 2, 2 },
    { 2, 0, 0, 3, 1 },
    { 2, 0, 1, 0, 3 },
    { 2, 0, 1, 3, 0 },
    { 2, 0, 2, 0, 2 },
    { 2, 0, 2, 2, 0 },
    { 2, 0, 3, 0, 1 },
    { 2, 0, 3, 1, 0 },
    { 2, 1, 0, 0, 3 },
    { 2, 1, 0, 3, 0 },
    { 2, 1, 3, 0, 0 },
    { 2, 2, 0, 0, 2 },
    { 2, 2, 0, 2, 0 },
    { 2, 2, 2, 0, 0 },
    { 2, 3, 0, 0, 1 },
    { 2, 3, 0, 1, 0 },
    { 2, 3, 1, 0, 0 },
    { 3, 0, 0, 1, 2 },
    { 3, 0, 0, 2, 1 },
    { 3, 0, 1, 0, 2 },
    { 3, 0, 1, 2, 0 },
    { 3, 0, 2, 0, 1 },
    { 3, 0, 2, 1, 0 },
    { 3, 1, 0, 0, 2 },
    { 3, 1, 0, 2, 0 },
    { 3, 1, 2, 0, 0 },
    { 3, 2, 0, 0, 1 },
    { 3, 2, 0, 1, 0 },
    { 3, 2, 1, 0, 0 }
    } },

    { { 6, 3 },
    { { 0, 0, 0, 3, 3 },
    { 0, 0, 3, 0, 3 },
    { 0, 0, 3, 3, 0 },
    { 0, 3, 0, 0, 3 },
    { 0, 3, 0, 3, 0 },
    { 0, 3, 3, 0, 0 },
    { 3, 0, 0, 0, 3 },
    { 3, 0, 0, 3, 0 },
    { 3, 0, 3, 0, 0 },
    { 3, 3, 0, 0, 0 }
    } },

    { { 7, 0 },
    { { 1, 1, 1, 1, 3 },
    { 1, 1, 1, 2, 2 },
    { 1, 1, 1, 3, 1 },
    { 1, 1, 2, 1, 2 },
    { 1, 1, 2, 2, 1 },
    { 1, 1, 3, 1, 1 },
    { 1, 2, 1, 1, 2 },
    { 1, 2, 1, 2, 1 },
    { 1, 2, 2, 1, 1 },
    { 1, 3, 1, 1, 1 },
    { 2, 1, 1, 1, 2 },
    { 2, 1, 1, 2, 1 },
    { 2, 1, 2, 1, 1 },
    { 2, 2, 1, 1, 1 },
    { 3, 1, 1, 1, 1 }
    } },

    { { 7, 1 },
    { { 0, 1, 1, 2, 3 },
    { 0, 1, 1, 3, 2 },
    { 0, 1, 2, 1, 3 },
    { 0, 1, 2, 2, 2 },
    { 0, 1, 2, 3, 1 },
    { 0, 1, 3, 1, 2 },
    { 0, 1, 3, 2, 1 },
    { 0, 2, 1, 1, 3 },
    { 0, 2, 1, 2, 2 },
    { 0, 2, 1, 3, 1 },
    { 0, 2, 2, 1, 2 },
    { 0, 2, 2, 2, 1 },
    { 0, 2, 3, 1, 1 },
    { 0, 3, 1, 1, 2 },
    { 0, 3, 1, 2, 1 },
    { 0, 3, 2, 1, 1 },
    { 1, 0, 1, 2, 3 },
    { 1, 0, 1, 3, 2 },
    { 1, 0, 2, 1, 3 },
    { 1, 0, 2, 2, 2 },
    { 1, 0, 2, 3, 1 },
    { 1, 0, 3, 1, 2 },
    { 1, 0, 3, 2, 1 },
    { 1, 1, 0, 2, 3 },
    { 1, 1, 0, 3, 2 },
    { 1, 1, 2, 0, 3 },
    { 1, 1, 2, 3, 0 },
    { 1, 1, 3, 0, 2 },
    { 1, 1, 3, 2, 0 },
    { 1, 2, 0, 1, 3 },
    { 1, 2, 0, 2, 2 },
    { 1, 2, 0, 3, 1 },
    { 1, 2, 1, 0, 3 },
    { 1, 2, 1, 3, 0 },
    { 1, 2, 2, 0, 2 },
    { 1, 2, 2, 2, 0 },
    { 1, 2, 3, 0, 1 },
    { 1, 2, 3, 1, 0 },
    { 1, 3, 0, 1, 2 },
    { 1, 3, 0, 2, 1 },
    { 1, 3, 1, 0, 2 },
    { 1, 3, 1, 2, 0 },
    { 1, 3, 2, 0, 1 },
    { 1, 3, 2, 1, 0 },
    { 2, 0, 1, 1, 3 },
    { 2, 0, 1, 2, 2 },
    { 2, 0, 1, 3, 1 },
    { 2, 0, 2, 1, 2 },
    { 2, 0, 2, 2, 1 },
    { 2, 0, 3, 1, 1 },
    { 2, 1, 0, 1, 3 },
    { 2, 1, 0, 2, 2 },
    { 2, 1, 0, 3, 1 },
    { 2, 1, 1, 0, 3 },
    { 2, 1, 1, 3, 0 },
    { 2, 1, 2, 0, 2 },
    { 2, 1, 2, 2, 0 },
    { 2, 1, 3, 0, 1 },
    { 2, 1, 3, 1, 0 },
    { 2, 2, 0, 1, 2 },
    { 2, 2, 0, 2, 1 },
    { 2, 2, 1, 0, 2 },
    { 2, 2, 1, 2, 0 },
    { 2, 2, 2, 0, 1 },
    { 2, 2, 2, 1, 0 },
    { 2, 3, 0, 1, 1 },
    { 2, 3, 1, 0, 1 },
    { 2, 3, 1, 1, 0 },
    { 3, 0, 1, 1, 2 },
    { 3, 0, 1, 2, 1 },
    { 3, 0, 2, 1, 1 },
    { 3, 1, 0, 1, 2 },
    { 3, 1, 0, 2, 1 },
    { 3, 1, 1, 0, 2 },
    { 3, 1, 1, 2, 0 },
    { 3, 1, 2, 0, 1 },
    { 3, 1, 2, 1, 0 },
    { 3, 2, 0, 1, 1 },
    { 3, 2, 1, 0, 1 },
    { 3, 2, 1, 1, 0 }
    } },

    { { 7, 2 },
    { { 0, 0, 1, 3, 3 },
    { 0, 0, 2, 2, 3 },
    { 0, 0, 2, 3, 2 },
    { 0, 0, 3, 1, 3 },
    { 0, 0, 3, 2, 2 },
    { 0, 0, 3, 3, 1 },
    { 0, 1, 0, 3, 3 },
    { 0, 1, 3, 0, 3 },
    { 0, 1, 3, 3, 0 },
    { 0, 2, 0, 2, 3 },
    { 0, 2, 0, 3, 2 },
    { 0, 2, 2, 0, 3 },
    { 0, 2, 2, 3, 0 },
    { 0, 2, 3, 0, 2 },
    { 0, 2, 3, 2, 0 },
    { 0, 3, 0, 1, 3 },
    { 0, 3, 0, 2, 2 },
    { 0, 3, 0, 3, 1 },
    { 0, 3, 1, 0, 3 },
    { 0, 3, 1, 3, 0 },
    { 0, 3, 2, 0, 2 },
    { 0, 3, 2, 2, 0 },
    { 0, 3, 3, 0, 1 },
    { 0, 3, 3, 1, 0 },
    { 1, 0, 0, 3, 3 },
    { 1, 0, 3, 0, 3 },
    { 1, 0, 3, 3, 0 },
    { 1, 3, 0, 0, 3 },
    { 1, 3, 0, 3, 0 },
    { 1, 3, 3, 0, 0 },
    { 2, 0, 0, 2, 3 },
    { 2, 0, 0, 3, 2 },
    { 2, 0, 2, 0, 3 },
    { 2, 0, 2, 3, 0 },
    { 2, 0, 3, 0, 2 },
    { 2, 0, 3, 2, 0 },
    { 2, 2, 0, 0, 3 },
    { 2, 2, 0, 3, 0 },
    { 2, 2, 3, 0, 0 },
    { 2, 3, 0, 0, 2 },
    { 2, 3, 0, 2, 0 },
    { 2, 3, 2, 0, 0 },
    { 3, 0, 0, 1, 3 },
    { 3, 0, 0, 2, 2 },
    { 3, 0, 0, 3, 1 },
    { 3, 0, 1, 0, 3 },
    { 3, 0, 1, 3, 0 },
    { 3, 0, 2, 0, 2 },
    { 3, 0, 2, 2, 0 },
    { 3, 0, 3, 0, 1 },
    { 3, 0, 3, 1, 0 },
    { 3, 1, 0, 0, 3 },
    { 3, 1, 0, 3, 0 },
    { 3, 1, 3, 0, 0 },
    { 3, 2, 0, 0, 2 },
    { 3, 2, 0, 2, 0 },
    { 3, 2, 2, 0, 0 },
    { 3, 3, 0, 0, 1 },
    { 3, 3, 0, 1, 0 },
    { 3, 3, 1, 0, 0 }
    } },

    { { 8, 0 },
    { { 1, 1, 1, 2, 3 },
    { 1, 1, 1, 3, 2 },
    { 1, 1, 2, 1, 3 },
    { 1, 1, 2, 2, 2 },
    { 1, 1, 2, 3, 1 },
    { 1, 1, 3, 1, 2 },
    { 1, 1, 3, 2, 1 },
    { 1, 2, 1, 1, 3 },
    { 1, 2, 1, 2, 2 },
    { 1, 2, 1, 3, 1 },
    { 1, 2, 2, 1, 2 },
    { 1, 2, 2, 2, 1 },
    { 1, 2, 3, 1, 1 },
    { 1, 3, 1, 1, 2 },
    { 1, 3, 1, 2, 1 },
    { 1, 3, 2, 1, 1 },
    { 2, 1, 1, 1, 3 },
    { 2, 1, 1, 2, 2 },
    { 2, 1, 1, 3, 1 },
    { 2, 1, 2, 1, 2 },
    { 2, 1, 2, 2, 1 },
    { 2, 1, 3, 1, 1 },
    { 2, 2, 1, 1, 2 },
    { 2, 2, 1, 2, 1 },
    { 2, 2, 2, 1, 1 },
    { 2, 3, 1, 1, 1 },
    { 3, 1, 1, 1, 2 },
    { 3, 1, 1, 2, 1 },
    { 3, 1, 2, 1, 1 },
    { 3, 2, 1, 1, 1 }
    } },

    { { 8, 1 },
    { { 0, 1, 1, 3, 3 },
    { 0, 1, 2, 2, 3 },
    { 0, 1, 2, 3, 2 },
    { 0, 1, 3, 1, 3 },
    { 0, 1, 3, 2, 2 },
    { 0, 1, 3, 3, 1 },
    { 0, 2, 1, 2, 3 },
    { 0, 2, 1, 3, 2 },
    { 0, 2, 2, 1, 3 },
    { 0, 2, 2, 2, 2 },
    { 0, 2, 2, 3, 1 },
    { 0, 2, 3, 1, 2 },
    { 0, 2, 3, 2, 1 },
    { 0, 3, 1, 1, 3 },
    { 0, 3, 1, 2, 2 },
    { 0, 3, 1, 3, 1 },
    { 0, 3, 2, 1, 2 },
    { 0, 3, 2, 2, 1 },
    { 0, 3, 3, 1, 1 },
    { 1, 0, 1, 3, 3 },
    { 1, 0, 2, 2, 3 },
    { 1, 0, 2, 3, 2 },
    { 1, 0, 3, 1, 3 },
    { 1, 0, 3, 2, 2 },
    { 1, 0, 3, 3, 1 },
    { 1, 1, 0, 3, 3 },
    { 1, 1, 3, 0, 3 },
    { 1, 1, 3, 3, 0 },
    { 1, 2, 0, 2, 3 },
    { 1, 2, 0, 3, 2 },
    { 1, 2, 2, 0, 3 },
    { 1, 2, 2, 3, 0 },
    { 1, 2, 3, 0, 2 },
    { 1, 2, 3, 2, 0 },
    { 1, 3, 0, 1, 3 },
    { 1, 3, 0, 2, 2 },
    { 1, 3, 0, 3, 1 },
    { 1, 3, 1, 0, 3 },
    { 1, 3, 1, 3, 0 },
    { 1, 3, 2, 0, 2 },
    { 1, 3, 2, 2, 0 },
    { 1, 3, 3, 0, 1 },
    { 1, 3, 3, 1, 0 },
    { 2, 0, 1, 2, 3 },
    { 2, 0, 1, 3, 2 },
    { 2, 0, 2, 1, 3 },
    { 2, 0, 2, 2, 2 },
    { 2, 0, 2, 3, 1 },
    { 2, 0, 3, 1, 2 },
    { 2, 0, 3, 2, 1 },
    { 2, 1, 0, 2, 3 },
    { 2, 1, 0, 3, 2 },
    { 2, 1, 2, 0, 3 },
    { 2, 1, 2, 3, 0 },
    { 2, 1, 3, 0, 2 },
    { 2, 1, 3, 2, 0 },
    { 2, 2, 0, 1, 3 },
    { 2, 2, 0, 2, 2 },
    { 2, 2, 0, 3, 1 },
    { 2, 2, 1, 0, 3 },
    { 2, 2, 1, 3, 0 },
    { 2, 2, 2, 0, 2 },
    { 2, 2, 2, 2, 0 },
    { 2, 2, 3, 0, 1 },
    { 2, 2, 3, 1, 0 },
    { 2, 3, 0, 1, 2 },
    { 2, 3, 0, 2, 1 },
    { 2, 3, 1, 0, 2 },
    { 2, 3, 1, 2, 0 },
    { 2, 3, 2, 0, 1 },
    { 2, 3, 2, 1, 0 },
    { 3, 0, 1, 1, 3 },
    { 3, 0, 1, 2, 2 },
    { 3, 0, 1, 3, 1 },
    { 3, 0, 2, 1, 2 },
    { 3, 0, 2, 2, 1 },
    { 3, 0, 3, 1, 1 },
    { 3, 1, 0, 1, 3 },
    { 3, 1, 0, 2, 2 },
    { 3, 1, 0, 3, 1 },
    { 3, 1, 1, 0, 3 },
    { 3, 1, 1, 3, 0 },
    { 3, 1, 2, 0, 2 },
    { 3, 1, 2, 2, 0 },
    { 3, 1, 3, 0, 1 },
    { 3, 1, 3, 1, 0 },
    { 3, 2, 0, 1, 2 },
    { 3, 2, 0, 2, 1 },
    { 3, 2, 1, 0, 2 },
    { 3, 2, 1, 2, 0 },
    { 3, 2, 2, 0, 1 },
    { 3, 2, 2, 1, 0 },
    { 3, 3, 0, 1, 1 },
    { 3, 3, 1, 0, 1 },
    { 3, 3, 1, 1, 0 }
    } },

    { { 8, 2 },
    { { 0, 0, 2, 3, 3 },
    { 0, 0, 3, 2, 3 },
    { 0, 0, 3, 3, 2 },
    { 0, 2, 0, 3, 3 },
    { 0, 2, 3, 0, 3 },
    { 0, 2, 3, 3, 0 },
    { 0, 3, 0, 2, 3 },
    { 0, 3, 0, 3, 2 },
    { 0, 3, 2, 0, 3 },
    { 0, 3, 2, 3, 0 },
    { 0, 3, 3, 0, 2 },
    { 0, 3, 3, 2, 0 },
    { 2, 0, 0, 3, 3 },
    { 2, 0, 3, 0, 3 },
    { 2, 0, 3, 3, 0 },
    { 2, 3, 0, 0, 3 },
    { 2, 3, 0, 3, 0 },
    { 2, 3, 3, 0, 0 },
    { 3, 0, 0, 2, 3 },
    { 3, 0, 0, 3, 2 },
    { 3, 0, 2, 0, 3 },
    { 3, 0, 2, 3, 0 },
    { 3, 0, 3, 0, 2 },
    { 3, 0, 3, 2, 0 },
    { 3, 2, 0, 0, 3 },
    { 3, 2, 0, 3, 0 },
    { 3, 2, 3, 0, 0 },
    { 3, 3, 0, 0, 2 },
    { 3, 3, 0, 2, 0 },
    { 3, 3, 2, 0, 0 }
    } },

    { { 9, 0 },
    { { 1, 1, 1, 3, 3 },
    { 1, 1, 2, 2, 3 },
    { 1, 1, 2, 3, 2 },
    { 1, 1, 3, 1, 3 },
    { 1, 1, 3, 2, 2 },
    { 1, 1, 3, 3, 1 },
    { 1, 2, 1, 2, 3 },
    { 1, 2, 1, 3, 2 },
    { 1, 2, 2, 1, 3 },
    { 1, 2, 2, 2, 2 },
    { 1, 2, 2, 3, 1 },
    { 1, 2, 3, 1, 2 },
    { 1, 2, 3, 2, 1 },
    { 1, 3, 1, 1, 3 },
    { 1, 3, 1, 2, 2 },
    { 1, 3, 1, 3, 1 },
    { 1, 3, 2, 1, 2 },
    { 1, 3, 2, 2, 1 },
    { 1, 3, 3, 1, 1 },
    { 2, 1, 1, 2, 3 },
    { 2, 1, 1, 3, 2 },
    { 2, 1, 2, 1, 3 },
    { 2, 1, 2, 2, 2 },
    { 2, 1, 2, 3, 1 },
    { 2, 1, 3, 1, 2 },
    { 2, 1, 3, 2, 1 },
    { 2, 2, 1, 1, 3 },
    { 2, 2, 1, 2, 2 },
    { 2, 2, 1, 3, 1 },
    { 2, 2, 2, 1, 2 },
    { 2, 2, 2, 2, 1 },
    { 2, 2, 3, 1, 1 },
    { 2, 3, 1, 1, 2 },
    { 2, 3, 1, 2, 1 },
    { 2, 3, 2, 1, 1 },
    { 3, 1, 1, 1, 3 },
    { 3, 1, 1, 2, 2 },
    { 3, 1, 1, 3, 1 },
    { 3, 1, 2, 1, 2 },
    { 3, 1, 2, 2, 1 },
    { 3, 1, 3, 1, 1 },
    { 3, 2, 1, 1, 2 },
    { 3, 2, 1, 2, 1 },
    { 3, 2, 2, 1, 1 },
    { 3, 3, 1, 1, 1 }
    } },

    { { 9, 1 },
    { { 0, 1, 2, 3, 3 },
    { 0, 1, 3, 2, 3 },
    { 0, 1, 3, 3, 2 },
    { 0, 2, 1, 3, 3 },
    { 0, 2, 2, 2, 3 },
    { 0, 2, 2, 3, 2 },
    { 0, 2, 3, 1, 3 },
    { 0, 2, 3, 2, 2 },
    { 0, 2, 3, 3, 1 },
    { 0, 3, 1, 2, 3 },
    { 0, 3, 1, 3, 2 },
    { 0, 3, 2, 1, 3 },
    { 0, 3, 2, 2, 2 },
    { 0, 3, 2, 3, 1 },
    { 0, 3, 3, 1, 2 },
    { 0, 3, 3, 2, 1 },
    { 1, 0, 2, 3, 3 },
    { 1, 0, 3, 2, 3 },
    { 1, 0, 3, 3, 2 },
    { 1, 2, 0, 3, 3 },
    { 1, 2, 3, 0, 3 },
    { 1, 2, 3, 3, 0 },
    { 1, 3, 0, 2, 3 },
    { 1, 3, 0, 3, 2 },
    { 1, 3, 2, 0, 3 },
    { 1, 3, 2, 3, 0 },
    { 1, 3, 3, 0, 2 },
    { 1, 3, 3, 2, 0 },
    { 2, 0, 1, 3, 3 },
    { 2, 0, 2, 2, 3 },
    { 2, 0, 2, 3, 2 },
    { 2, 0, 3, 1, 3 },
    { 2, 0, 3, 2, 2 },
    { 2, 0, 3, 3, 1 },
    { 2, 1, 0, 3, 3 },
    { 2, 1, 3, 0, 3 },
    { 2, 1, 3, 3, 0 },
    { 2, 2, 0, 2, 3 },
    { 2, 2, 0, 3, 2 },
    { 2, 2, 2, 0, 3 },
    { 2, 2, 2, 3, 0 },
    { 2, 2, 3, 0, 2 },
    { 2, 2, 3, 2, 0 },
    { 2, 3, 0, 1, 3 },
    { 2, 3, 0, 2, 2 },
    { 2, 3, 0, 3, 1 },
    { 2, 3, 1, 0, 3 },
    { 2, 3, 1, 3, 0 },
    { 2, 3, 2, 0, 2 },
    { 2, 3, 2, 2, 0 },
    { 2, 3, 3, 0, 1 },
    { 2, 3, 3, 1, 0 },
    { 3, 0, 1, 2, 3 },
    { 3, 0, 1, 3, 2 },
    { 3, 0, 2, 1, 3 },
    { 3, 0, 2, 2, 2 },
    { 3, 0, 2, 3, 1 },
    { 3, 0, 3, 1, 2 },
    { 3, 0, 3, 2, 1 },
    { 3, 1, 0, 2, 3 },
    { 3, 1, 0, 3, 2 },
    { 3, 1, 2, 0, 3 },
    { 3, 1, 2, 3, 0 },
    { 3, 1, 3, 0, 2 },
    { 3, 1, 3, 2, 0 },
    { 3, 2, 0, 1, 3 },
    { 3, 2, 0, 2, 2 },
    { 3, 2, 0, 3, 1 },
    { 3, 2, 1, 0, 3 },
    { 3, 2, 1, 3, 0 },
    { 3, 2, 2, 0, 2 },
    { 3, 2, 2, 2, 0 },
    { 3, 2, 3, 0, 1 },
    { 3, 2, 3, 1, 0 },
    { 3, 3, 0, 1, 2 },
    { 3, 3, 0, 2, 1 },
    { 3, 3, 1, 0, 2 },
    { 3, 3, 1, 2, 0 },
    { 3, 3, 2, 0, 1 },
    { 3, 3, 2, 1, 0 }
    } },

    { { 9, 2 },
    { { 0, 0, 3, 3, 3 },
    { 0, 3, 0, 3, 3 },
    { 0, 3, 3, 0, 3 },
    { 0, 3, 3, 3, 0 },
    { 3, 0, 0, 3, 3 },
    { 3, 0, 3, 0, 3 },
    { 3, 0, 3, 3, 0 },
    { 3, 3, 0, 0, 3 },
    { 3, 3, 0, 3, 0 },
    { 3, 3, 3, 0, 0 }
    } },

    { { 10, 0 },
    { { 1, 1, 2, 3, 3 },
    { 1, 1, 3, 2, 3 },
    { 1, 1, 3, 3, 2 },
    { 1, 2, 1, 3, 3 },
    { 1, 2, 2, 2, 3 },
    { 1, 2, 2, 3, 2 },
    { 1, 2, 3, 1, 3 },
    { 1, 2, 3, 2, 2 },
    { 1, 2, 3, 3, 1 },
    { 1, 3, 1, 2, 3 },
    { 1, 3, 1, 3, 2 },
    { 1, 3, 2, 1, 3 },
    { 1, 3, 2, 2, 2 },
    { 1, 3, 2, 3, 1 },
    { 1, 3, 3, 1, 2 },
    { 1, 3, 3, 2, 1 },
    { 2, 1, 1, 3, 3 },
    { 2, 1, 2, 2, 3 },
    { 2, 1, 2, 3, 2 },
    { 2, 1, 3, 1, 3 },
    { 2, 1, 3, 2, 2 },
    { 2, 1, 3, 3, 1 },
    { 2, 2, 1, 2, 3 },
    { 2, 2, 1, 3, 2 },
    { 2, 2, 2, 1, 3 },
    { 2, 2, 2, 2, 2 },
    { 2, 2, 2, 3, 1 },
    { 2, 2, 3, 1, 2 },
    { 2, 2, 3, 2, 1 },
    { 2, 3, 1, 1, 3 },
    { 2, 3, 1, 2, 2 },
    { 2, 3, 1, 3, 1 },
    { 2, 3, 2, 1, 2 },
    { 2, 3, 2, 2, 1 },
    { 2, 3, 3, 1, 1 },
    { 3, 1, 1, 2, 3 },
    { 3, 1, 1, 3, 2 },
    { 3, 1, 2, 1, 3 },
    { 3, 1, 2, 2, 2 },
    { 3, 1, 2, 3, 1 },
    { 3, 1, 3, 1, 2 },
    { 3, 1, 3, 2, 1 },
    { 3, 2, 1, 1, 3 },
    { 3, 2, 1, 2, 2 },
    { 3, 2, 1, 3, 1 },
    { 3, 2, 2, 1, 2 },
    { 3, 2, 2, 2, 1 },
    { 3, 2, 3, 1, 1 },
    { 3, 3, 1, 1, 2 },
    { 3, 3, 1, 2, 1 },
    { 3, 3, 2, 1, 1 }
    } },

    { { 10, 1 },
    { { 0, 1, 3, 3, 3 },
    { 0, 2, 2, 3, 3 },
    { 0, 2, 3, 2, 3 },
    { 0, 2, 3, 3, 2 },
    { 0, 3, 1, 3, 3 },
    { 0, 3, 2, 2, 3 },
    { 0, 3, 2, 3, 2 },
    { 0, 3, 3, 1, 3 },
    { 0, 3, 3, 2, 2 },
    { 0, 3, 3, 3, 1 },
    { 1, 0, 3, 3, 3 },
    { 1, 3, 0, 3, 3 },
    { 1, 3, 3, 0, 3 },
    { 1, 3, 3, 3, 0 },
    { 2, 0, 2, 3, 3 },
    { 2, 0, 3, 2, 3 },
    { 2, 0, 3, 3, 2 },
    { 2, 2, 0, 3, 3 },
    { 2, 2, 3, 0, 3 },
    { 2, 2, 3, 3, 0 },
    { 2, 3, 0, 2, 3 },
    { 2, 3, 0, 3, 2 },
    { 2, 3, 2, 0, 3 },
    { 2, 3, 2, 3, 0 },
    { 2, 3, 3, 0, 2 },
    { 2, 3, 3, 2, 0 },
    { 3, 0, 1, 3, 3 },
    { 3, 0, 2, 2, 3 },
    { 3, 0, 2, 3, 2 },
    { 3, 0, 3, 1, 3 },
    { 3, 0, 3, 2, 2 },
    { 3, 0, 3, 3, 1 },
    { 3, 1, 0, 3, 3 },
    { 3, 1, 3, 0, 3 },
    { 3, 1, 3, 3, 0 },
    { 3, 2, 0, 2, 3 },
    { 3, 2, 0, 3, 2 },
    { 3, 2, 2, 0, 3 },
    { 3, 2, 2, 3, 0 },
    { 3, 2, 3, 0, 2 },
    { 3, 2, 3, 2, 0 },
    { 3, 3, 0, 1, 3 },
    { 3, 3, 0, 2, 2 },
    { 3, 3, 0, 3, 1 },
    { 3, 3, 1, 0, 3 },
    { 3, 3, 1, 3, 0 },
    { 3, 3, 2, 0, 2 },
    { 3, 3, 2, 2, 0 },
    { 3, 3, 3, 0, 1 },
    { 3, 3, 3, 1, 0 }
    } },

    { { 11, 0 },
    { { 1, 1, 3, 3, 3 },
    { 1, 2, 2, 3, 3 },
    { 1, 2, 3, 2, 3 },
    { 1, 2, 3, 3, 2 },
    { 1, 3, 1, 3, 3 },
    { 1, 3, 2, 2, 3 },
    { 1, 3, 2, 3, 2 },
    { 1, 3, 3, 1, 3 },
    { 1, 3, 3, 2, 2 },
    { 1, 3, 3, 3, 1 },
    { 2, 1, 2, 3, 3 },
    { 2, 1, 3, 2, 3 },
    { 2, 1, 3, 3, 2 },
    { 2, 2, 1, 3, 3 },
    { 2, 2, 2, 2, 3 },
    { 2, 2, 2, 3, 2 },
    { 2, 2, 3, 1, 3 },
    { 2, 2, 3, 2, 2 },
    { 2, 2, 3, 3, 1 },
    { 2, 3, 1, 2, 3 },
    { 2, 3, 1, 3, 2 },
    { 2, 3, 2, 1, 3 },
    { 2, 3, 2, 2, 2 },
    { 2, 3, 2, 3, 1 },
    { 2, 3, 3, 1, 2 },
    { 2, 3, 3, 2, 1 },
    { 3, 1, 1, 3, 3 },
    { 3, 1, 2, 2, 3 },
    { 3, 1, 2, 3, 2 },
    { 3, 1, 3, 1, 3 },
    { 3, 1, 3, 2, 2 },
    { 3, 1, 3, 3, 1 },
    { 3, 2, 1, 2, 3 },
    { 3, 2, 1, 3, 2 },
    { 3, 2, 2, 1, 3 },
    { 3, 2, 2, 2, 2 },
    { 3, 2, 2, 3, 1 },
    { 3, 2, 3, 1, 2 },
    { 3, 2, 3, 2, 1 },
    { 3, 3, 1, 1, 3 },
    { 3, 3, 1, 2, 2 },
    { 3, 3, 1, 3, 1 },
    { 3, 3, 2, 1, 2 },
    { 3, 3, 2, 2, 1 },
    { 3, 3, 3, 1, 1 }
    } },

    { { 11, 1 },
    { { 0, 2, 3, 3, 3 },
    { 0, 3, 2, 3, 3 },
    { 0, 3, 3, 2, 3 },
    { 0, 3, 3, 3, 2 },
    { 2, 0, 3, 3, 3 },
    { 2, 3, 0, 3, 3 },
    { 2, 3, 3, 0, 3 },
    { 2, 3, 3, 3, 0 },
    { 3, 0, 2, 3, 3 },
    { 3, 0, 3, 2, 3 },
    { 3, 0, 3, 3, 2 },
    { 3, 2, 0, 3, 3 },
    { 3, 2, 3, 0, 3 },
    { 3, 2, 3, 3, 0 },
    { 3, 3, 0, 2, 3 },
    { 3, 3, 0, 3, 2 },
    { 3, 3, 2, 0, 3 },
    { 3, 3, 2, 3, 0 },
    { 3, 3, 3, 0, 2 },
    { 3, 3, 3, 2, 0 }
    } },

    { { 12, 0 },
    { { 1, 2, 3, 3, 3 },
    { 1, 3, 2, 3, 3 },
    { 1, 3, 3, 2, 3 },
    { 1, 3, 3, 3, 2 },
    { 2, 1, 3, 3, 3 },
    { 2, 2, 2, 3, 3 },
    { 2, 2, 3, 2, 3 },
    { 2, 2, 3, 3, 2 },
    { 2, 3, 1, 3, 3 },
    { 2, 3, 2, 2, 3 },
    { 2, 3, 2, 3, 2 },
    { 2, 3, 3, 1, 3 },
    { 2, 3, 3, 2, 2 },
    { 2, 3, 3, 3, 1 },
    { 3, 1, 2, 3, 3 },
    { 3, 1, 3, 2, 3 },
    { 3, 1, 3, 3, 2 },
    { 3, 2, 1, 3, 3 },
    { 3, 2, 2, 2, 3 },
    { 3, 2, 2, 3, 2 },
    { 3, 2, 3, 1, 3 },
    { 3, 2, 3, 2, 2 },
    { 3, 2, 3, 3, 1 },
    { 3, 3, 1, 2, 3 },
    { 3, 3, 1, 3, 2 },
    { 3, 3, 2, 1, 3 },
    { 3, 3, 2, 2, 2 },
    { 3, 3, 2, 3, 1 },
    { 3, 3, 3, 1, 2 },
    { 3, 3, 3, 2, 1 }
    } },

    { { 12, 1 },
    { { 0, 3, 3, 3, 3 },
    { 3, 0, 3, 3, 3 },
    { 3, 3, 0, 3, 3 },
    { 3, 3, 3, 0, 3 },
    { 3, 3, 3, 3, 0 }
    } },

    { { 13, 0 },
    { { 1, 3, 3, 3, 3 },
    { 2, 2, 3, 3, 3 },
    { 2, 3, 2, 3, 3 },
    { 2, 3, 3, 2, 3 },
    { 2, 3, 3, 3, 2 },
    { 3, 1, 3, 3, 3 },
    { 3, 2, 2, 3, 3 },
    { 3, 2, 3, 2, 3 },
    { 3, 2, 3, 3, 2 },
    { 3, 3, 1, 3, 3 },
    { 3, 3, 2, 2, 3 },
    { 3, 3, 2, 3, 2 },
    { 3, 3, 3, 1, 3 },
    { 3, 3, 3, 2, 2 },
    { 3, 3, 3, 3, 1 }
    } },

    { { 14, 0 },
    { { 2, 3, 3, 3, 3 },
    { 3, 2, 3, 3, 3 },
    { 3, 3, 2, 3, 3 },
    { 3, 3, 3, 2, 3 },
    { 3, 3, 3, 3, 2 }
    } },

    { { 15, 0 },
    { { 3, 3, 3, 3, 3 }
    } }
};
